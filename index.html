<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Coin Flip App</title>
   <script src="https://telegram.org/js/telegram-web-app.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.9.6/lottie.min.js"></script>
   <link rel="stylesheet" href="styles.css">
</head>
<body>

    <!-- HEADER -->
    <header class="header">
       <div class="user-info">
          <p class="username" id="username">User</p>
          <p class="welcome-text">Welcome Back 
             <img 
                src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Telegram-Animated-Emojis/main/Travel%20and%20Places/Rocket.webp" 
                alt="Rocket Emoji" 
                width="30"  <!-- Increased size -->
          </p>
       </div>
       <img src="profile.png" alt="Profile Picture" id="profile-pic" class="profile-pic">
    </header>

<!-- Balance & Withdraw Container -->
<div class="balance-container">
   <!-- Wrapper to ensure icon and balance text stay together -->
   <div class="balance-wrapper">
       <!-- ALGO Icon -->
       <img src="algo-icon.png" alt="Algo Icon" class="algo-icon">
       
       <!-- Balance Text -->
       <div class="balance-text">
          <p class="balance-label">Balance</p>
          <p class="user-balance" id="user-balance">Loading...</p> <!-- Initially show loading -->
       </div>
   </div>

   <!-- The Withdraw Button is now used for refreshing the balance -->
   <button class="withdraw-button" onclick="refreshBalance()">Refresh</button> <!-- Refresh functionality on Withdraw Button -->
</div>

    <!-- Coin Flip Animation -->
    <div id="coin-flip-container">
       <div id="coin-animation"></div>
    </div>

    <!-- Heads & Tails Selection -->
    <div class="button-container">
       <button class="coin-button" id="heads">
          <div class="top">HEADS</div>
          <div class="bottom"></div>
       </button>
       <button class="coin-button" id="tails">
          <div class="top">TAILS</div>
          <div class="bottom"></div>
       </button>
    </div>

    <!-- Spin Button -->
    <div class="spin-container">
       <button class="spin-button">
          <div class="top">
             SPIN 
             <img 
                src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Telegram-Animated-Emojis/main/Objects/Money%20Bag.webp"  
                alt="Money Bag Emoji" 
                width="30"  <!-- Increased size -->
          </div>
          <div class="bottom"></div>
       </button>
    </div>

    <!-- Display User ID Section -->
    <div class="user-id-container">
        <p><strong>User ID:</strong> <span id="user-id">Loading...</span></p>
        <p id="wallet-address">Loading Wallet Address...</p>
    </div>

    <script src="script.js" defer></script>
    <script>
        let tg = window.Telegram.WebApp;
    
        // Get user details
        let username = tg.initDataUnsafe?.user?.first_name || "User";
        let userId = tg.initDataUnsafe?.user?.id || null;
        
        // Display username
        document.getElementById("username").innerText = username;

        // Display user ID
        if (userId) {
            document.getElementById("user-id").innerText = userId;
        } else {
            document.getElementById("user-id").innerText = "Not available";
        }

        // Load Coin Flip Animation
        var animation = lottie.loadAnimation({
           container: document.getElementById("coin-animation"),
           renderer: "svg",
           loop: true,
           autoplay: true,
           path: "animation.json"
        });
    
        // Handle Heads & Tails Button Selection with Haptic Feedback
        document.querySelectorAll(".coin-button").forEach(button => {
            button.addEventListener("click", function() {
                // Remove active state from all buttons
                document.querySelectorAll(".coin-button").forEach(btn => {
                    btn.classList.remove("active");
                });
    
                // Add active state to clicked button
                this.classList.add("active");
    
                // Apply LIGHT haptic feedback for heads/tails
                Telegram.WebApp.HapticFeedback.impactOccurred('light');
            });
        });
    
        // Handle Withdraw Button with SOFT Haptic Feedback
        document.querySelector(".withdraw-button").addEventListener("click", function() {
            Telegram.WebApp.HapticFeedback.impactOccurred('soft');
        });
    
        // Handle Spin Button with HEAVY Haptic Feedback
        document.querySelector(".spin-button").addEventListener("click", function() {
            Telegram.WebApp.HapticFeedback.impactOccurred('heavy');
        });
    
    </script>    
     <!-- Link to the addressfetch.js -->
    <script src="addressfetch.js" defer></script>
    <script src="script.js" defer></script>
</body>
</html>
